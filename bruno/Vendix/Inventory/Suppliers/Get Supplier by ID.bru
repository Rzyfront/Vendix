meta {
  name: Get Supplier by ID
  type: http
  seq: 3
}

get {
  url: {{baseUrl}}/api/suppliers/sup_123456789012345678
  auth: bearer
}

headers {
  Content-Type: application/json
  Authorization: Bearer {{authToken}}
}

tests {
  test("Should get supplier by ID successfully", function() {
    expect(res.status).to.equal(200);
    expect(res.body).to.be.an('object');
    expect(res.body).to.have.property('id', 'sup_123456789012345678');
    expect(res.body).to.have.property('name');
    expect(res.body).to.have.property('code');
    expect(res.body).to.have.property('email');
    expect(res.body).to.have.property('phone');
    expect(res.body).to.have.property('website');
    expect(res.body).to.have.property('taxId');
    expect(res.body).to.have.property('type');
    expect(res.body).to.have.property('status');
    expect(res.body).to.have.property('paymentTerms');
    expect(res.body).to.have.property('currency');
    expect(res.body).to.have.property('addresses').that.is.an('array');
    expect(res.body).to.have.property('contacts').that.is.an('array');
    expect(res.body).to.have.property('notes');
    expect(res.body).to.have.property('createdAt');
    expect(res.body).to.have.property('updatedAt');
  });

  test("Should validate addresses structure", function() {
    expect(res.body.addresses).to.be.an('array');
    if (res.body.addresses.length > 0) {
      res.body.addresses.forEach(address => {
        expect(address).to.have.property('id');
        expect(address).to.have.property('type');
        expect(address).to.have.property('street');
        expect(address).to.have.property('city');
        expect(address).to.have.property('state');
        expect(address).to.have.property('postalCode');
        expect(address).to.have.property('country');
        expect(address).to.have.property('isPrimary');
        expect(['BILLING', 'SHIPPING', 'BOTH']).to.include(address.type);
        expect(address.isPrimary).to.be.a('boolean');
      });
    }
  });

  test("Should validate contacts structure", function() {
    expect(res.body.contacts).to.be.an('array');
    if (res.body.contacts.length > 0) {
      res.body.contacts.forEach(contact => {
        expect(contact).to.have.property('id');
        expect(contact).to.have.property('name');
        expect(contact).to.have.property('title');
        expect(contact).to.have.property('email');
        expect(contact).to.have.property('phone');
        expect(contact).to.have.property('isPrimary');
        expect(contact.name).to.be.a('string');
        expect(contact.email).to.match(/^[^\s@]+@[^\s@]+\.[^\s@]+$/);
        expect(contact.isPrimary).to.be.a('boolean');
      });
    }
  });

  test("Should validate primary contact exists", function() {
    const primaryContacts = res.body.contacts.filter(contact => contact.isPrimary === true);
    expect(primaryContacts.length).to.be.at.least(1);
  });

  test("Should validate primary address exists", function() {
    const primaryAddresses = res.body.addresses.filter(address => address.isPrimary === true);
    expect(primaryAddresses.length).to.be.at.least(1);
  });

  test("Should validate response time", function() {
    expect(res.responseTime).to.be.below(2000);
  });

  test("Should validate supplier type", function() {
    const validTypes = ['MANUFACTURER', 'DISTRIBUTOR', 'WHOLESALER', 'RETAILER', 'SERVICE_PROVIDER'];
    expect(validTypes).to.include(res.body.type);
  });

  test("Should validate supplier status", function() {
    const validStatuses = ['ACTIVE', 'INACTIVE', 'PENDING', 'SUSPENDED'];
    expect(validStatuses).to.include(res.body.status);
  });

  test("Should validate payment terms", function() {
    const validPaymentTerms = ['NET_15', 'NET_30', 'NET_45', 'NET_60', 'COD', 'PREPAID'];
    expect(validPaymentTerms).to.include(res.body.paymentTerms);
  });

  test("Should validate currency format", function() {
    expect(res.body.currency).to.match(/^[A-Z]{3}$/);
  });

  test("Should validate website format", function() {
    if (res.body.website) {
      expect(res.body.website).to.match(/^https?:\/\/.+/);
    }
  });

  test("Should validate tax ID format", function() {
    if (res.body.taxId) {
      expect(res.body.taxId).to.match(/^[\d\-\s]+$/);
    }
  });

  test("Should validate phone number format", function() {
    if (res.body.phone) {
      expect(res.body.phone).to.match(/^\+?[\d\s\-\(\)]+$/);
    }
  });

  test("Should validate email format", function() {
    if (res.body.email) {
      expect(res.body.email).to.match(/^[^\s@]+@[^\s@]+\.[^\s@]+$/);
    }
  });

  test("Should validate supplier code format", function() {
    expect(res.body.code).to.match(/^[A-Z]{3}-\d{3}$/);
  });
}