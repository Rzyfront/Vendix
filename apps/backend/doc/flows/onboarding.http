# üéØ COMPLETE ONBOARDING FLOW
# Flujo completo de registro y configuraci√≥n inicial para Organization Owner

@baseUrl = http://localhost:3000/api
@ownerToken = YOUR_JWT_TOKEN_HERE
@organizationId = YOUR_ORG_ID_HERE
@storeId = YOUR_STORE_ID_HERE
@addressId = YOUR_ADDRESS_ID_HERE
@domainId = YOUR_DOMAIN_ID_HERE

###

# =================================================================
# üìù STEP 1: OWNER REGISTRATION
# =================================================================

### Register Organization Owner (Start Onboarding)
POST {{baseUrl}}/auth/register-owner
Content-Type: application/json

{
  "email": "owner@company.com",
  "password": "SecurePass123!",
  "first_name": "John",
  "last_name": "Smith",
  "organization_name": "Tech Solutions Inc"
}

# Response: { user, organization, tokens, onboarding_status }

###

# =================================================================
# üìß STEP 2: EMAIL VERIFICATION
# =================================================================

### Verify Email Address
POST {{baseUrl}}/auth/verify-email
Content-Type: application/json

{
  "token": "EMAIL_VERIFICATION_TOKEN_FROM_EMAIL"
}

### Resend Verification Email (if needed)
POST {{baseUrl}}/auth/resend-verification
Content-Type: application/json
Authorization: Bearer {{ownerToken}}

{
  "email": "owner@company.com"
}

###

# =================================================================
# üîë STEP 3: AUTHENTICATION & CONTEXT
# =================================================================

### Login After Email Verification
POST {{baseUrl}}/auth/login
Content-Type: application/json

{
  "email": "owner@company.com",
  "password": "SecurePass123!"
}

# Save the token from response to @ownerToken variable

### Get Current User Profile
GET {{baseUrl}}/auth/me
Content-Type: application/json
Authorization: Bearer {{ownerToken}}

### Check Onboarding Status
GET {{baseUrl}}/auth/onboarding/status
Content-Type: application/json
Authorization: Bearer {{ownerToken}}

###

# =================================================================
# üë§ STEP 4: COMPLETE USER PROFILE
# =================================================================

### Update User Profile with Complete Information
PATCH {{baseUrl}}/users/{{ownerToken.user_id}}
Content-Type: application/json
Authorization: Bearer {{ownerToken}}

{
  "first_name": "John",
  "last_name": "Smith",
  "phone": "+1234567890",
  "bio": "Tech entrepreneur and founder"
}

###

# =================================================================
# üè¢ STEP 5: ORGANIZATION SETUP
# =================================================================

### Create Organization During Onboarding
POST {{baseUrl}}/auth/onboarding/create-organization
Content-Type: application/json
Authorization: Bearer {{ownerToken}}

{
  "name": "Tech Solutions Inc",
  "description": "Technology solutions provider",
  "industry": "Technology",
  "website": "https://techsolutions.com",
  "phone": "+1234567890"
}

# Save organization ID from response to @organizationId variable

### Setup Organization Details
POST {{baseUrl}}/auth/onboarding/setup-organization/{{organizationId}}
Content-Type: application/json
Authorization: Bearer {{ownerToken}}

{
  "settings": {
    "timezone": "America/New_York",
    "currency": "USD",
    "language": "en",
    "date_format": "MM/DD/YYYY"
  },
  "billing": {
    "tax_id": "123456789",
    "billing_email": "billing@company.com"
  }
}

### Create Organization Address
POST {{baseUrl}}/addresses
Content-Type: application/json
Authorization: Bearer {{ownerToken}}

{
  "street_address": "123 Business Ave",
  "city": "San Francisco",
  "state": "CA",
  "postal_code": "94105",
  "country": "US",
  "address_type": "business",
  "is_primary": true,
  "organization_id": {{organizationId}}
}

# Save address ID from response to @addressId variable

###

# =================================================================
# üè™ STEP 6: STORE SETUP
# =================================================================

### Create Store During Onboarding
POST {{baseUrl}}/auth/onboarding/create-store/{{organizationId}}
Content-Type: application/json
Authorization: Bearer {{ownerToken}}

{
  "name": "Main Store",
  "description": "Primary retail location",
  "store_type": "retail",
  "phone": "+1234567890",
  "email": "store@company.com"
}

# Save store ID from response to @storeId variable

### Setup Store Details
POST {{baseUrl}}/auth/onboarding/setup-store/{{storeId}}
Content-Type: application/json
Authorization: Bearer {{ownerToken}}

{
  "settings": {
    "timezone": "America/New_York",
    "currency": "USD",
    "language": "en",
    "inventory_tracking": true,
    "tax_calculation": true
  },
  "business_hours": {
    "monday": { "open": "09:00", "close": "18:00" },
    "tuesday": { "open": "09:00", "close": "18:00" },
    "wednesday": { "open": "09:00", "close": "18:00" },
    "thursday": { "open": "09:00", "close": "18:00" },
    "friday": { "open": "09:00", "close": "18:00" },
    "saturday": { "open": "10:00", "close": "16:00" },
    "sunday": { "closed": true }
  }
}

### Create Store Address
POST {{baseUrl}}/addresses
Content-Type: application/json
Authorization: Bearer {{ownerToken}}

{
  "street_address": "456 Retail Street",
  "city": "San Francisco",
  "state": "CA",
  "postal_code": "94102",
  "country": "US",
  "address_type": "store",
  "is_primary": true,
  "store_id": {{storeId}}
}

###

# =================================================================
# üåê STEP 7: DOMAIN CONFIGURATION
# =================================================================

### Check Domain Availability
GET {{baseUrl}}/domains/check/techsolutions.myapp.com
Content-Type: application/json
Authorization: Bearer {{ownerToken}}

### Create Domain Setting
POST {{baseUrl}}/domains
Content-Type: application/json
Authorization: Bearer {{ownerToken}}

{
  "hostname": "techsolutions.myapp.com",
  "domain_type": "primary",
  "is_active": true,
  "ssl_enabled": false,
  "organization_id": {{organizationId}},
  "store_id": {{storeId}},
  "settings": {
    "branding": {
      "primary_color": "#007bff",
      "secondary_color": "#6c757d",
      "logo_url": "https://example.com/logo.png"
    },
    "features": {
      "ecommerce": true,
      "inventory": true,
      "analytics": true
    }
  }
}

# Save domain ID from response to @domainId variable

### Verify Domain DNS Configuration
POST {{baseUrl}}/domains/hostname/techsolutions.myapp.com/verify
Content-Type: application/json
Authorization: Bearer {{ownerToken}}

###

# =================================================================
# üéØ STEP 8: FINALIZE ONBOARDING
# =================================================================

### Complete Onboarding Process
POST {{baseUrl}}/auth/onboarding/complete
Content-Type: application/json
Authorization: Bearer {{ownerToken}}

{
  "organization_id": {{organizationId}},
  "store_id": {{storeId}},
  "domain_id": {{domainId}}
}

### Verify Final User State
GET {{baseUrl}}/auth/me
Content-Type: application/json
Authorization: Bearer {{ownerToken}}

# Response should show:
# {
#   "email_verified": true,
#   "state": "active",
#   "onboarding_completed": true,
#   "roles": ["owner"],
#   "organization": { "id": {{organizationId}}, "name": "Tech Solutions Inc" },
#   "store": { "id": {{storeId}}, "name": "Main Store" }
# }

### Get Organization Dashboard Stats
GET {{baseUrl}}/organizations/{{organizationId}}/stats
Content-Type: application/json
Authorization: Bearer {{ownerToken}}

### Get Store Dashboard Stats
GET {{baseUrl}}/stores/{{storeId}}/stats
Content-Type: application/json
Authorization: Bearer {{ownerToken}}

### Test Domain Resolution
GET {{baseUrl}}/domains/resolve/techsolutions.myapp.com
Content-Type: application/json

###

# =================================================================
# üìã SUMMARY OF COMPLETE ONBOARDING
# =================================================================
# 
# ‚úÖ User registered and email verified
# ‚úÖ User profile completed with phone and bio
# ‚úÖ Organization created with full details and address
# ‚úÖ Store created with settings, business hours and address
# ‚úÖ Domain configured and verified
# ‚úÖ Onboarding marked as complete
# ‚úÖ User has owner role with full permissions
# ‚úÖ Dashboard stats available for organization and store
# ‚úÖ Domain resolution working correctly
#
# The user now has full access to:
# - Organization management
# - Store management  
# - User management (invite staff)
# - Domain configuration
# - Analytics and reporting
# - All platform features
