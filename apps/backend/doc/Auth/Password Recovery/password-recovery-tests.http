### VENDIX - Password Recovery API Tests
### Archivo para probar los endpoints de recuperación de contraseña

@baseUrl = http://localhost:3000/api

### ============================================
### 0. HEALTH CHECK - Verificar servidor
### ============================================
GET {{baseUrl}}/health

### ============================================
### 1. FORGOT PASSWORD - Solicitud exitosa
### ============================================
POST {{baseUrl}}/auth/forgot-password
Content-Type: application/json

{
  "email": "test@example.com"
}

### ============================================
### 2. FORGOT PASSWORD - Email no existente
### ============================================
POST {{baseUrl}}/auth/forgot-password
Content-Type: application/json

{
  "email": "nonexistent@example.com"
}

### ============================================
### 3. RESET PASSWORD - Token válido
### ============================================
POST {{baseUrl}}/auth/reset-password
Content-Type: application/json

{
  "token": "valid_reset_token_here",
  "newPassword": "NewPassword@123"
}

### ============================================
### 4. RESET PASSWORD - Token expirado
### ============================================
POST {{baseUrl}}/auth/reset-password
Content-Type: application/json

{
  "token": "expired_token_here",
  "newPassword": "NewPassword@123"
}

### ============================================
### 5. RESET PASSWORD - Token ya usado
### ============================================
POST {{baseUrl}}/auth/reset-password
Content-Type: application/json

{
  "token": "used_token_here",
  "newPassword": "NewPassword@123"
}

### ============================================
### 6. RESET PASSWORD - Token inválido
### ============================================
POST {{baseUrl}}/auth/reset-password
Content-Type: application/json

{
  "token": "invalid_token_12345",
  "newPassword": "NewPassword@123"
}

### ============================================
### 7. RESET PASSWORD - Contraseña débil
### ============================================
POST {{baseUrl}}/auth/reset-password
Content-Type: application/json

{
  "token": "valid_reset_token_here",
  "newPassword": "weak"
}

### ============================================
### 8. RESET PASSWORD - Contraseña igual a la actual
### ============================================
POST {{baseUrl}}/auth/reset-password
Content-Type: application/json

{
  "token": "valid_reset_token_here",
  "newPassword": "CurrentPassword@123"
}

### ============================================
### 9. CHANGE PASSWORD - Usuario autenticado
### ============================================
POST {{baseUrl}}/auth/change-password
Authorization: Bearer YOUR_ACCESS_TOKEN_HERE
Content-Type: application/json

{
  "currentPassword": "CurrentPassword@123",
  "newPassword": "NewPassword@123"
}

### ============================================
### 10. CHANGE PASSWORD - Contraseña actual incorrecta
### ============================================
POST {{baseUrl}}/auth/change-password
Authorization: Bearer YOUR_ACCESS_TOKEN_HERE
Content-Type: application/json

{
  "currentPassword": "WrongPassword@123",
  "newPassword": "NewPassword@123"
}

### ============================================
### 11. RATE LIMITING TEST - Múltiples intentos
### ============================================
POST {{baseUrl}}/auth/forgot-password
Content-Type: application/json

{
  "email": "test@example.com"
}

###
POST {{baseUrl}}/auth/forgot-password
Content-Type: application/json

{
  "email": "test@example.com"
}

###
POST {{baseUrl}}/auth/forgot-password
Content-Type: application/json

{
  "email": "test@example.com"
}

###
POST {{baseUrl}}/auth/forgot-password
Content-Type: application/json

{
  "email": "test@example.com"
}

###
POST {{baseUrl}}/auth/forgot-password
Content-Type: application/json

{
  "email": "test@example.com"
}

###
POST {{baseUrl}}/auth/forgot-password
Content-Type: application/json

{
  "email": "test@example.com"
}

### ============================================
### 12. RESET PASSWORD - Usuario inactivo
### ============================================
POST {{baseUrl}}/auth/reset-password
Content-Type: application/json

{
  "token": "inactive_user_token",
  "newPassword": "NewPassword@123"
}

### ============================================
### 13. FORGOT PASSWORD - Email con caracteres especiales
### ============================================
POST {{baseUrl}}/auth/forgot-password
Content-Type: application/json

{
  "email": "test.email+tag@example.com"
}

### ============================================
### 14. RESET PASSWORD - Contraseña muy fuerte
### ============================================
POST {{baseUrl}}/auth/reset-password
Content-Type: application/json

{
  "token": "valid_reset_token_here",
  "newPassword": "MySuperSecurePassword@2025!"
}

### ============================================
### 15. CHANGE PASSWORD - Contraseña sin números
### ============================================
POST {{baseUrl}}/auth/change-password
Authorization: Bearer YOUR_ACCESS_TOKEN_HERE
Content-Type: application/json

{
  "currentPassword": "CurrentPassword@123",
  "newPassword": "NewPasswordOnlyLetters"
}

### ============================================
### 16. CHANGE PASSWORD - Contraseña sin mayúsculas
### ============================================
POST {{baseUrl}}/auth/change-password
Authorization: Bearer YOUR_ACCESS_TOKEN_HERE
Content-Type: application/json

{
  "currentPassword": "CurrentPassword@123",
  "newPassword": "newpassword123"
}

### ============================================
### 17. CHANGE PASSWORD - Contraseña sin minúsculas
### ============================================
POST {{baseUrl}}/auth/change-password
Authorization: Bearer YOUR_ACCESS_TOKEN_HERE
Content-Type: application/json

{
  "currentPassword": "CurrentPassword@123",
  "newPassword": "NEWPASSWORD123"
}

### ============================================
### 18. FORGOT PASSWORD - Email vacío
### ============================================
POST {{baseUrl}}/auth/forgot-password
Content-Type: application/json

{
  "email": ""
}

### ============================================
### 19. RESET PASSWORD - Token vacío
### ============================================
POST {{baseUrl}}/auth/reset-password
Content-Type: application/json

{
  "token": "",
  "newPassword": "NewPassword@123"
}

### ============================================
### 20. RESET PASSWORD - Contraseña vacía
### ============================================
POST {{baseUrl}}/auth/reset-password
Content-Type: application/json

{
  "token": "valid_reset_token_here",
  "newPassword": ""
}
