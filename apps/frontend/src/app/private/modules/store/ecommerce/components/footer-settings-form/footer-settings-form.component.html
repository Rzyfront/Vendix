<form [formGroup]="footerForm" class="space-y-6">
  <!-- SECCIÓN 1: INFORMACIÓN DE LA TIENDA -->
  <div class="border border-gray-200 rounded-lg overflow-hidden">
    <button type="button" (click)="toggleSection('store_info')"
      class="w-full flex items-center justify-between p-4 bg-gray-50 hover:bg-gray-100 transition-colors">
      <div class="flex items-center gap-3">
        <div class="w-8 h-8 rounded-lg bg-blue-100 flex items-center justify-center">
          <app-icon name="store" size="18" class="text-blue-600"></app-icon>
        </div>
        <span class="font-medium text-gray-900">Información de la Tienda</span>
      </div>
      <app-icon [name]="expandedSections.store_info ? 'chevron-up' : 'chevron-down'" size="20"
        class="text-gray-500"></app-icon>
    </button>

    @if (expandedSections.store_info) {
    <div class="p-4 space-y-4 animate-in fade-in slide-in-from-top-2 duration-200" formGroupName="store_info">
      <!-- Sobre Nosotros -->
      <div class="space-y-1.5">
        <label class="block text-sm font-medium text-gray-700">Sobre Nosotros</label>
        <textarea formControlName="about_us" rows="4"
          placeholder="Escribe un relato sobre tu tienda. Este texto se mostrará cuando los clientes hagan clic en 'Sobre Nosotros' en el footer..."
          class="w-full px-3 py-2 rounded-lg bg-white border border-gray-300 text-sm focus:border-primary-500 focus:ring-2 focus:ring-primary-500/20 outline-none resize-none"></textarea>
        <small class="text-xs text-gray-500">Se mostrará en un modal al hacer clic en "Sobre Nosotros"</small>
      </div>

      <!-- Email de Soporte -->
      <app-input label="Correo de Soporte" type="email" formControlName="support_email"
        placeholder="soporte@tutienda.com" helperText="Este correo aparecerá en el footer para que los clientes puedan contactarte">
      </app-input>

      <!-- Frase del Footer -->
      <app-input label="Frase del Footer" formControlName="tagline"
        placeholder="Tu tienda de confianza para productos de calidad"
        helperText="Una frase corta que describa tu tienda (aparece debajo del nombre)">
      </app-input>
    </div>
    }
  </div>

  <!-- SECCIÓN 2: ENLACES DE INTERÉS -->
  <div class="border border-gray-200 rounded-lg overflow-hidden">
    <button type="button" (click)="toggleSection('links')"
      class="w-full flex items-center justify-between p-4 bg-gray-50 hover:bg-gray-100 transition-colors">
      <div class="flex items-center gap-3">
        <div class="w-8 h-8 rounded-lg bg-purple-100 flex items-center justify-center">
          <app-icon name="link" size="18" class="text-purple-600"></app-icon>
        </div>
        <span class="font-medium text-gray-900">Enlaces de Interés</span>
        <span class="text-xs text-gray-500">({{ linksArray.length }}/5)</span>
      </div>
      <app-icon [name]="expandedSections.links ? 'chevron-up' : 'chevron-down'" size="20"
        class="text-gray-500"></app-icon>
    </button>

    @if (expandedSections.links) {
    <div class="p-4 space-y-4 animate-in fade-in slide-in-from-top-2 duration-200">
      <p class="text-sm text-gray-500">
        Configura los enlaces que aparecerán en la sección "Enlaces" del footer. Máximo 5 enlaces.
      </p>

      <!-- Lista de enlaces -->
      <div class="space-y-3" formArrayName="links">
        @for (link of linksArray.controls; track link; let i = $index) {
        <div class="flex items-start gap-3 p-3 bg-gray-50 rounded-lg border border-gray-200" [formGroupName]="i">
          <div class="flex-1 grid grid-cols-1 md:grid-cols-2 gap-3">
            <app-input label="Texto del enlace" formControlName="label" placeholder="Ej: Productos"
              customWrapperClass="!mt-0"></app-input>
            <app-input label="URL" formControlName="url" placeholder="Ej: /products o https://..."
              customWrapperClass="!mt-0"></app-input>
          </div>
          <div class="flex items-center gap-2 pt-6">
            <label class="flex items-center gap-1.5 text-xs text-gray-600 cursor-pointer">
              <input type="checkbox" formControlName="is_external"
                class="w-4 h-4 rounded border-gray-300 text-primary-600 focus:ring-primary-500" />
              <span>Externo</span>
            </label>
            <button type="button" (click)="removeLink(i)"
              class="p-1.5 text-red-500 hover:bg-red-50 rounded-lg transition-colors">
              <app-icon name="trash-2" size="16"></app-icon>
            </button>
          </div>
        </div>
        }
      </div>

      @if (linksArray.length < 5) {
      <button type="button" (click)="addLink()"
        class="w-full py-2 px-4 border-2 border-dashed border-gray-300 rounded-lg text-sm text-gray-600 hover:border-primary-500 hover:text-primary-600 hover:bg-primary-50 transition-all flex items-center justify-center gap-2">
        <app-icon name="plus" size="16"></app-icon>
        Agregar Enlace
      </button>
      }
    </div>
    }
  </div>

  <!-- SECCIÓN 3: AYUDA -->
  <div class="border border-gray-200 rounded-lg overflow-hidden">
    <button type="button" (click)="toggleSection('help')"
      class="w-full flex items-center justify-between p-4 bg-gray-50 hover:bg-gray-100 transition-colors">
      <div class="flex items-center gap-3">
        <div class="w-8 h-8 rounded-lg bg-green-100 flex items-center justify-center">
          <app-icon name="help-circle" size="18" class="text-green-600"></app-icon>
        </div>
        <span class="font-medium text-gray-900">Ayuda al Cliente</span>
      </div>
      <app-icon [name]="expandedSections.help ? 'chevron-up' : 'chevron-down'" size="20"
        class="text-gray-500"></app-icon>
    </button>

    @if (expandedSections.help) {
    <div class="p-4 space-y-6 animate-in fade-in slide-in-from-top-2 duration-200" formGroupName="help">
      <!-- Preguntas Frecuentes -->
      <div class="space-y-3">
        <div class="flex items-center justify-between">
          <h4 class="text-sm font-medium text-gray-700">Preguntas Frecuentes (FAQ)</h4>
          <span class="text-xs text-gray-500">{{ faqArray.length }} preguntas</span>
        </div>

        <div class="space-y-2" formArrayName="faq">
          @for (faq of faqArray.controls; track faq; let i = $index) {
          <div class="border border-gray-200 rounded-lg overflow-hidden" [formGroupName]="i">
            <!-- FAQ Header -->
            <div class="flex items-center justify-between p-3 bg-gray-50 cursor-pointer hover:bg-gray-100 transition-colors"
              (click)="toggleFaqItem(i)">
              <div class="flex items-center gap-2 flex-1 min-w-0">
                <app-icon [name]="expandedFaqIndex === i ? 'chevron-down' : 'chevron-right'" size="16"
                  class="text-gray-500 flex-shrink-0"></app-icon>
                <span class="text-sm font-medium text-gray-700 truncate">
                  {{ faq.get('question')?.value || 'Nueva pregunta...' }}
                </span>
              </div>
              <button type="button" (click)="$event.stopPropagation(); removeFaqItem(i)"
                class="p-1 text-red-500 hover:bg-red-50 rounded transition-colors">
                <app-icon name="trash-2" size="14"></app-icon>
              </button>
            </div>

            <!-- FAQ Content -->
            @if (expandedFaqIndex === i) {
            <div class="p-3 space-y-3 border-t border-gray-200 animate-in fade-in slide-in-from-top-1 duration-150">
              <app-input label="Pregunta" formControlName="question" placeholder="¿Cómo puedo realizar un pedido?"
                customWrapperClass="!mt-0"></app-input>
              <div class="space-y-1.5">
                <label class="block text-sm font-medium text-gray-700">Respuesta</label>
                <textarea formControlName="answer" rows="3"
                  placeholder="Escribe la respuesta a esta pregunta..."
                  class="w-full px-3 py-2 rounded-lg bg-white border border-gray-300 text-sm focus:border-primary-500 focus:ring-2 focus:ring-primary-500/20 outline-none resize-none"></textarea>
              </div>
            </div>
            }
          </div>
          }
        </div>

        <button type="button" (click)="addFaqItem()"
          class="w-full py-2 px-4 border-2 border-dashed border-gray-300 rounded-lg text-sm text-gray-600 hover:border-green-500 hover:text-green-600 hover:bg-green-50 transition-all flex items-center justify-center gap-2">
          <app-icon name="plus" size="16"></app-icon>
          Agregar Pregunta
        </button>
      </div>

      <!-- Información de Envíos -->
      <div class="space-y-1.5">
        <label class="block text-sm font-medium text-gray-700">Información de Envíos</label>
        <textarea formControlName="shipping_info" rows="4"
          placeholder="Realizamos envíos a todo el país. El tiempo de entrega varía según tu ubicación..."
          class="w-full px-3 py-2 rounded-lg bg-white border border-gray-300 text-sm focus:border-primary-500 focus:ring-2 focus:ring-primary-500/20 outline-none resize-none"></textarea>
        <small class="text-xs text-gray-500">Se mostrará al hacer clic en "Envíos" en el footer</small>
      </div>

      <!-- Política de Devoluciones -->
      <div class="space-y-1.5">
        <label class="block text-sm font-medium text-gray-700">Política de Devoluciones</label>
        <textarea formControlName="returns_info" rows="4"
          placeholder="Si no estás satisfecho con tu compra, puedes solicitar una devolución dentro de los 30 días..."
          class="w-full px-3 py-2 rounded-lg bg-white border border-gray-300 text-sm focus:border-primary-500 focus:ring-2 focus:ring-primary-500/20 outline-none resize-none"></textarea>
        <small class="text-xs text-gray-500">Se mostrará al hacer clic en "Devoluciones" en el footer</small>
      </div>
    </div>
    }
  </div>

  <!-- SECCIÓN 4: REDES SOCIALES -->
  <div class="border border-gray-200 rounded-lg overflow-hidden">
    <button type="button" (click)="toggleSection('social')"
      class="w-full flex items-center justify-between p-4 bg-gray-50 hover:bg-gray-100 transition-colors">
      <div class="flex items-center gap-3">
        <div class="w-8 h-8 rounded-lg bg-pink-100 flex items-center justify-center">
          <app-icon name="share-2" size="18" class="text-pink-600"></app-icon>
        </div>
        <span class="font-medium text-gray-900">Redes Sociales</span>
      </div>
      <app-icon [name]="expandedSections.social ? 'chevron-up' : 'chevron-down'" size="20"
        class="text-gray-500"></app-icon>
    </button>

    @if (expandedSections.social) {
    <div class="p-4 space-y-4 animate-in fade-in slide-in-from-top-2 duration-200" formGroupName="social">
      <p class="text-sm text-gray-500">
        Configura tus redes sociales. Los iconos aparecerán en el footer solo si completas la URL.
      </p>

      <!-- Facebook -->
      <div class="p-4 bg-blue-50/50 rounded-lg border border-blue-100" formGroupName="facebook">
        <div class="flex items-center gap-2 mb-3">
          <div class="w-6 h-6 rounded bg-blue-600 flex items-center justify-center">
            <i class="pi pi-facebook text-white text-sm"></i>
          </div>
          <span class="font-medium text-gray-900">Facebook</span>
        </div>
        <div class="grid grid-cols-1 md:grid-cols-2 gap-3">
          <app-input label="Usuario" formControlName="username" placeholder="@tutienda"
            customWrapperClass="!mt-0"></app-input>
          <app-input label="URL del Perfil" formControlName="url" placeholder="https://facebook.com/tutienda"
            customWrapperClass="!mt-0"></app-input>
        </div>
      </div>

      <!-- Instagram -->
      <div class="p-4 bg-pink-50/50 rounded-lg border border-pink-100" formGroupName="instagram">
        <div class="flex items-center gap-2 mb-3">
          <div class="w-6 h-6 rounded bg-gradient-to-br from-purple-600 via-pink-600 to-orange-500 flex items-center justify-center">
            <i class="pi pi-instagram text-white text-sm"></i>
          </div>
          <span class="font-medium text-gray-900">Instagram</span>
        </div>
        <div class="grid grid-cols-1 md:grid-cols-2 gap-3">
          <app-input label="Usuario" formControlName="username" placeholder="@tutienda"
            customWrapperClass="!mt-0"></app-input>
          <app-input label="URL del Perfil" formControlName="url" placeholder="https://instagram.com/tutienda"
            customWrapperClass="!mt-0"></app-input>
        </div>
      </div>

      <!-- TikTok -->
      <div class="p-4 bg-gray-50 rounded-lg border border-gray-200" formGroupName="tiktok">
        <div class="flex items-center gap-2 mb-3">
          <div class="w-6 h-6 rounded bg-black flex items-center justify-center">
            <app-icon name="brand-tiktok" size="14" class="text-white"></app-icon>
          </div>
          <span class="font-medium text-gray-900">TikTok</span>
        </div>
        <div class="grid grid-cols-1 md:grid-cols-2 gap-3">
          <app-input label="Usuario" formControlName="username" placeholder="@tutienda"
            customWrapperClass="!mt-0"></app-input>
          <app-input label="URL del Perfil" formControlName="url" placeholder="https://tiktok.com/@tutienda"
            customWrapperClass="!mt-0"></app-input>
        </div>
      </div>
    </div>
    }
  </div>
</form>
