<div class="md:space-y-4">
  <!-- Lista de Gastos -->
  <div class="md:bg-surface md:rounded-xl md:shadow-[0_2px_8px_rgba(0,0,0,0.07)] md:border md:border-border md:min-h-[600px] md:overflow-hidden">
    <!-- Search Section: sticky below stats on mobile, normal on desktop -->
    <div class="sticky top-[99px] z-10 bg-background px-2 py-1.5 pt-[5px] -mt-[5px] md:mt-0 md:pt-4 md:static md:bg-transparent md:px-6 md:py-4 md:border-b md:border-border">
      <div class="flex flex-col gap-2 md:flex-row md:justify-between md:items-center md:gap-4">
        <!-- Title - smaller on mobile, larger on desktop -->
        <h2 class="text-[13px] font-bold text-gray-600 tracking-wide md:text-lg md:font-semibold md:text-text-primary">
          Gastos ({{ filteredExpenses().length }})
        </h2>

        <!-- Search row - horizontal on mobile -->
        <div class="flex items-center gap-2 w-full md:w-auto">
          <app-inputsearch
            class="flex-1 md:w-64 shadow-[0_2px_8px_rgba(0,0,0,0.07)] md:shadow-none rounded-[10px]"
            size="sm"
            placeholder="Buscar gastos..."
            [debounceTime]="300"
            [ngModel]="searchTerm"
            (ngModelChange)="onSearchChange($event)"
          ></app-inputsearch>

          <app-options-dropdown
            class="shadow-[0_2px_8px_rgba(0,0,0,0.07)] md:shadow-none rounded-[10px]"
            [filters]="filterConfigs"
            [filterValues]="filterValues"
            [actions]="dropdownActions"
            [isLoading]="loading"
            (filterChange)="onFilterChange($event)"
            (clearAllFilters)="onClearFilters()"
            (actionClick)="onActionClick($event)"
          ></app-options-dropdown>
        </div>
      </div>
    </div>

    <!-- Loading State -->
    <div *ngIf="loading" class="p-4 md:p-6 text-center">
      <div class="inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-primary"></div>
      <p class="mt-2 text-text-secondary">Cargando gastos...</p>
    </div>

    <!-- Empty State -->
    <div *ngIf="!loading && filteredExpenses().length === 0" class="p-8 text-center">
      <div class="w-16 h-16 mx-auto mb-4 rounded-full bg-gray-100 flex items-center justify-center">
        <!-- Coins icon (registered) -->
        <svg class="w-8 h-8 text-gray-400" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" viewBox="0 0 24 24">
          <circle cx="8" cy="8" r="6"/>
          <path d="M18.09 10.37A6 6 0 1 1 10.34 18"/>
          <path d="M7 6h1v4"/>
          <path d="m16.71 13.88.7.71-2.82 2.82"/>
        </svg>
      </div>
      <h3 class="text-lg font-medium text-text-primary mb-2">{{ getEmptyStateTitle() }}</h3>
      <p class="text-text-secondary mb-4">{{ getEmptyStateDescription() }}</p>
      <div class="flex flex-col items-center sm:flex-row gap-2 justify-center">
        <app-button variant="primary" (clicked)="create.emit()">
          Crear nuevo gasto
        </app-button>
        <app-button
          *ngIf="hasFilters"
          variant="ghost"
          (clicked)="onClearFilters()"
        >
          Limpiar filtros
        </app-button>
      </div>
    </div>

    <!-- Expenses List -->
    <div *ngIf="!loading && filteredExpenses().length > 0" class="px-2 pb-2 pt-3 md:p-4">
      <app-responsive-data-view
        [data]="filteredExpenses()"
        [columns]="columns"
        [actions]="tableActions"
        [cardConfig]="cardConfig"
        [loading]="loading"
        emptyMessage="No hay gastos registrados"
        emptyIcon="coins"
        (rowClick)="onRowClick($event)"
      ></app-responsive-data-view>
    </div>
  </div>
</div>
