<div class="space-y-6">
  <!-- Stats Cards -->
  <app-store-stats [stats]="stats"></app-store-stats>

  <!-- Stores List -->
  <div class="bg-surface rounded-card shadow-card border border-border">
    <div class="px-6 py-4 border-b border-border">
      <div
        class="flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4"
      >
        <div class="flex-1 min-w-0">
          <h2 class="text-lg font-semibold text-text-primary">
            Todas las Tiendas ({{ stores.length }})
          </h2>
        </div>

        <div
          class="flex flex-col sm:flex-row items-stretch sm:items-center gap-3 w-full sm:w-auto"
        >
          <!-- Input de búsqueda compacto -->
          <app-inputsearch
            class="w-full sm:w-64"
            size="sm"
            placeholder="Buscar tiendas..."
            [debounceTime]="1000"
            (searchChange)="onSearchChange($event)"
          ></app-inputsearch>

          <!-- Filtro de tipo de tienda -->
          <select
            class="px-3 py-2 border border-border rounded-input focus:outline-none focus:ring-2 focus:ring-primary focus:border-primary bg-surface text-text-primary text-sm"
            (change)="onStoreTypeChange($event)"
            [value]="selectedStoreType"
          >
            <option value="">Todos los Tipos</option>
            <option value="physical">Tienda Física</option>
            <option value="online">Tienda Online</option>
            <option value="hybrid">Tienda Híbrida</option>
            <option value="popup">Tienda Temporal</option>
            <option value="kiosko">Kiosco</option>
          </select>

          <!-- Filtro de estado -->
          <select
            class="px-3 py-2 border border-border rounded-input focus:outline-none focus:ring-2 focus:ring-primary focus:border-primary bg-surface text-text-primary text-sm"
            (change)="onStateChange($event)"
            [value]="selectedState"
          >
            <option value="">Todos los Estados</option>
            <option value="active">Activa</option>
            <option value="inactive">Inactiva</option>
          </select>

          <div class="flex gap-2 items-center">
            <app-button
              variant="outline"
              size="sm"
              (clicked)="refreshStores()"
              [disabled]="isLoading"
              title="Actualizar lista"
            >
              <app-icon name="refresh" [size]="16" slot="icon"></app-icon>
            </app-button>
            <app-button
              variant="primary"
              size="sm"
              (clicked)="openCreateStoreModal()"
              title="Crear Nueva Tienda"
            >
              <app-icon name="plus" [size]="16" slot="icon"></app-icon>
              <span class="hidden sm:inline">Nueva Tienda</span>
            </app-button>
          </div>
        </div>
      </div>
    </div>

    <!-- Loading State -->
    <div *ngIf="isLoading" class="p-8 text-center">
      <div
        class="inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-primary"
      ></div>
      <p class="mt-2 text-text-secondary">Cargando tiendas...</p>
    </div>

    <!-- Empty State -->
    <app-store-empty-state
      *ngIf="!isLoading && stores.length === 0"
      [title]="getEmptyStateTitle()"
      [description]="getEmptyStateDescription()"
      [showAdditionalActions]="hasFilters"
      (actionClick)="openCreateStoreModal()"
      (refreshClick)="refreshStores()"
      (clearFiltersClick)="clearFilters()"
    >
    </app-store-empty-state>

    <!-- Stores Table -->
    <div *ngIf="!isLoading && stores.length > 0" class="p-6">
      <app-table
        [data]="stores"
        [columns]="tableColumns"
        [actions]="tableActions"
        [loading]="isLoading"
        [sortable]="true"
        [hoverable]="true"
        [striped]="true"
        size="md"
        (sort)="onTableSort($event)"
        (rowClick)="viewStore($event)"
      >
      </app-table>
    </div>
  </div>

  <!-- Create Store Modal -->
  <app-store-create-modal
    [isOpen]="isCreateModalOpen"
    [isSubmitting]="isCreatingStore"
    (openChange)="onCreateModalChange($event)"
    (submit)="createStore($event)"
    (cancel)="onCreateModalCancel()"
  ></app-store-create-modal>

  <!-- Edit Store Modal -->
  <app-store-edit-modal
    [isOpen]="isEditModalOpen"
    [isSubmitting]="isUpdatingStore"
    [store]="selectedStore"
    (openChange)="onEditModalChange($event)"
    (submit)="updateStore($event)"
    (cancel)="onEditModalCancel()"
  ></app-store-edit-modal>

  <!-- Settings Store Modal -->
  <app-store-settings-modal
    *ngIf="selectedStoreForSettings"
    [isOpen]="isSettingsModalOpen"
    [isSubmitting]="isUpdatingSettings"
    (openChange)="onSettingsModalChange($event)"
    (submit)="updateStoreSettings($event)"
    (cancel)="onSettingsModalCancel()"
  ></app-store-settings-modal>
</div>
